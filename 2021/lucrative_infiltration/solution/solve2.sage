from hashlib import sha256
from Crypto.Util.number import *

q = 89666094075799358333912553751544914665545515386283824011992558231120286657213785559151513056027280869020616111209289142073255564770995469726364925295894316484503027288982119436576308594740674437582226015660087863550818792499346330713413631956572604302171842281106323020998625124370502577704273068156073608681
p = 2*q + 1
g = 5
H = sha256
threshold = 166

# 006706ff90d78db7250d3f248650f94aae5c28928e9d1cef93f1b70807e6f191 -> f5990eeefca620422958b78af88059399a41c72cf186bdc09f837b6c7fbf8645 : 134 ph0wncoins.
# Signature (r,s) : (27143138898011628593297284078215553316825299312987525751005744264459461538302471378994972237498504885469484376092978622360113707900406504806411839337276602569244657343434098467468892073254136162514203096161224810462999125251230579156604497227823545174606075881718986762823248511080658787978724933540701149648,22893531956028755223814309922698070816467638174996291852638433566279414516994518463731357722048460110961219705330472818627118950431132568573910665868472146457092336611723409553398762277055004270542433013257683263718783941722006768932715069424327726480285814327392721583489374283752545977977173165091804323434)

source_addr = "006706ff90d78db7250d3f248650f94aae5c28928e9d1cef93f1b70807e6f191"
dest_addr = "f5990eeefca620422958b78af88059399a41c72cf186bdc09f837b6c7fbf8645"
money = 134
r = 27143138898011628593297284078215553316825299312987525751005744264459461538302471378994972237498504885469484376092978622360113707900406504806411839337276602569244657343434098467468892073254136162514203096161224810462999125251230579156604497227823545174606075881718986762823248511080658787978724933540701149648
s = 22893531956028755223814309922698070816467638174996291852638433566279414516994518463731357722048460110961219705330472818627118950431132568573910665868472146457092336611723409553398762277055004270542433013257683263718783941722006768932715069424327726480285814327392721583489374283752545977977173165091804323434

m = (source_addr + " -> " + dest_addr + ": " + str(money))
h = int(H(m).hexdigest(),16)

K = 3490237590235790325739153749052839407
mat = [[(p-1) * K, 0, 0, 0],[-h * K,2**(3 * threshold // 2), 0, 0],[s*K,0,1,0],[r*K,0,0,1]]


M = Matrix(ZZ,mat)

M_LLL = M.LLL()

privkey = int(M_LLL[0,3])
print(privkey)
